<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.complitex.osznconnection.file.service.AddressCorrectionBean">

    <select id="find" parameterType="org.complitex.osznconnection.file.entity.AddressCorrection" resultType="long">
        SELECT ac.`internal_object_id` internalObjectId FROM `address_correction` ac
        WHERE ac.`organization_id` = #{organizationId}
        <if test="city != null">
            AND ac.`city` = #{city}
        </if>
        <if test="street != null">
            AND ac.`street` = #{street}
        </if>
        <if test="building != null">
            AND ac.`building` = #{building}
        </if>
        <if test="apartment != null">
            AND ac.`apartment` = #{apartment}
        </if>
        AND ac.`internal_object_entity_id` = (SELECT e.`id` FROM `entity` e WHERE e.`entity_table` = #{internalObjectEntity})
        LIMIT 0,1
    </select>

    <insert id="insert" parameterType="org.complitex.osznconnection.file.entity.AddressCorrection">
        INSERT INTO `address_correction`(`organization_id`, `city`, `street`, `building`, `apartment`, `internal_object_id`, `internal_object_entity_id`) VALUES
                                        (#{organizationId}, #{city}, #{street}, #{building}, #{apartment}, #{internalObjectId}, #{internalObjectEntityId})
    </insert>


</mapper>