#summary Обновление структуры адресного справочника.

= Introduction =

Обновление структуры адресного справочника.


= Details =

Новая структура адресного справочника должна исправить следующие замечания к существующей:

 # Сейчас сущности и их коррекции находятся в отдельных специализированных таблицах, в то время как все типы и их коррекции хранятся в общей таблице: это ведет к тому, что запросы имеют не самодокументируемый вид, структура справочников получается не прозрачной.
 # При наличии иерархии улицы и дома как наследники населенного пункта хранение связи дома и улицы (адреса здания) как атрибута дома потенциально опасно для целостности и непротиворечивости данных, запросы для вычисления и построения адресов получаются громоздкими.
 # Не все связи получается прикрыть форенкеями.


Объекты предметной области: страна, регион, нас.пункт, район, улица, адрес здания, здание, квартира.

Справочники типов: нас.пункта, улицы.

 * Страна - родителя не имеет, атрибут только один: название (не множественный, обязательный).
 * Регион - родитель страна, атрибут только один: название (не множественный, обязательный).
 * Населенный пункт - родитель регион (возможно, пустой регион для населенных пунктов, входящих напрямую в страну), атрибуты: название (не множественный, обязательный), тип (не множественный, обязательный).
 * Улица - родитель нас.пункт, атрибуты: название (не множественный, обязательный), тип (не множественный, обязательный).
 * Район - родитель нас.пункт, атрибут название (не множественный, обязательный).
 * Адрес здания - родитель улица (возможно, пустая улица для зданий, входящих напрямую в населенный пункт), атрибуты:  номер дома (не множественный, обязательный), номер корпуса (не множественный, не обязательный), номер строения (не множественный, не обязательный).
 * Здание - родитель основной адрес, атрибуты: альтернативный адрес (множественный, не обязательный), район (не множественный, не обязательный) (т.к. у района родительская сущность нас.пункт, то нас.пункт должен быть согласован с улицей из основного адреса).
 * Квартира - родитель здание, атрибут только один - номер (не множественный, обязательный).